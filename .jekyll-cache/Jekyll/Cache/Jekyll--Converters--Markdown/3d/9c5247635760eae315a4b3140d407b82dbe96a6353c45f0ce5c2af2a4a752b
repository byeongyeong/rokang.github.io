I"<p>앱이 Foreground(Active, inActive)에 있을 때와 Background에 있을 때의 차이점을 알아본다.
각 상태에서 어떤 일을 할 수 있고 할 수 없는 지에 대해 파악하는 것은 실제 개발을 할 때 매우 중요하다.</p>

<h2 id="ios-앱-라이프사이클">iOS 앱 라이프사이클</h2>
<p>iOS 13에서 Scene이 도입되면서 앱은 Scene-based 앱과 그렇지 않은 일반 앱으로 나뉜다.
그에 따라 라이프사이클 이벤트에 대응되는 객체도 UISceneDelegate, UIApplicationDelegate로 나뉘는데,
Scene에 관련된 내용은 나중에 정리하도록하고 먼저 App-based 기준으로 iOS 앱의 라이프사이클을 알아본다.</p>

<p align="center">
   <img src="../images/2021-05-08-til-20210508/1.png" width="500" />
   <em style="font-size: 0.9em;">출처: Apple Developer</em>
</p>
<p><br /></p>

<p>iOS 12 이하 버전이나 Scene을 지원하지 않는 앱에서 UIKit은 모든 라이프사이클 이벤트를 UIApplicationDelegate로 전달한다.
이러한 앱 delegate는 분리된 스크린에서 보여지는 것들을 포함한 앱의 모든 window를 관리한다. 그에 따라 앱의 상태 변화는 외부 디스플레이의 컨텐츠를 포함한
앱 전체의 UI에 영향을 미친다.</p>

<p>위의 그림은 앱 delegate 객체와 관련된 앱의 상태 변화를 보여준다. 앱이 실행되면 시스템은 UI가 스크린에 보여지는지 아닌지 여부에 따라
앱을 Inactive나 Background 상태로 만든다. 앱이 Foreground로 시작될 때, 시스템은 자동으로 앱을 Active 상태로 바꾼다.
그 후, 앱은 Terminated 되기 전까지 Active와 Background 사이에서 변동된다.</p>

<p>따라서 App-based 라이프사이클에서 앱이 갖게되는 상태는 5가지로 나뉜다.</p>

<ol>
  <li><code class="highlighter-rouge">Not Running</code> : App이 실행되지 않은 상태. App이 실행되기 전이거나 혹은 실행되었지만 System에 의해 종료된 상태.</li>
  <li><code class="highlighter-rouge">Inactive</code> : App이 실행 중이지만 이벤트를 받고있지 않은 상태. 전화가 왔을때, 앱 실행 중 미리알림 또는 일정 얼럿이 화면에 덮인 상태, 앱 스위처 상태 등 앱이 실질적으로 이벤트는 받지 못하는 상태.</li>
  <li><code class="highlighter-rouge">Active</code> : 어플리케이션이 실질적으로 활동하고 있는 상태.</li>
  <li><code class="highlighter-rouge">Background</code> : 백그라운드 상태에서 실질적인 동작을 하고 있는 상태. 예를 들어 백그라운드에서 음악을 실행하거나, 걸어온 길을 트래킹 하는 등의 동 뜻합니다.</li>
  <li><code class="highlighter-rouge">Suspended</code> : 백그라운드 상태에서 활동을 멈춘 상태. 빠른 재실행을 위하여 메모리에 적재된 상태지만 실질적으로 동작하고 있지는 않습니다. 메모리가 부족할때 비로소 시스템이 강제종료하게 됩니다.</li>
</ol>

<p>대부분의 상태 전환은 AppDelegate객체의 메소드 호출을 거칩니다. AppDelegate 객체는 UIResponder, UIApplicationDelegate를 상속 및 델리게이트 참조하고 있습니다.
UIApplicationDelegate은 UIApplication 객체의 작업에 개발자가 접근할 수 있도록 하는 메소드들을 담고 있습니다.</p>

<p>https://eunjin3786.tistory.com/163
https://developer.apple.com/documentation/uikit/app_and_environment/managing_your_app_s_life_cycle</p>

<h2 id="foreground-제약사항">Foreground 제약사항</h2>
<p>더 효율적인 작업을 위해 Qos(Quality of service)를 고려해야한다.
더 깊은 내용은 추후 정리할 예정. 컨셉만 소개</p>

<p>https://zeddios.tistory.com/521</p>

<h2 id="background-제약사항">Background 제약사항</h2>
<p>백그라운드에서 약간의 작업이 필요할 때
https://hamait.tistory.com/715</p>

<p>NSURLSession로 다운로드나 전송할 때도 백그라운드에서 별도의 세팅을 해주어야 함
https://rhammer.tistory.com/109</p>

<p>백그라운드 모드를 활용해야 원하는 Task를 수행할 수 있음
https://hamait.tistory.com/715</p>

<p>보통 뭐 리소스 제약사항임
https://developer.apple.com/documentation/uikit/app_and_environment/scenes/preparing_your_ui_to_run_in_the_background</p>

<p>저전력모드에서 임의로 백그라운드 태스킹이 종료될 수 있음
https://developer.apple.com/library/archive/documentation/Performance/Conceptual/EnergyGuide-iOS/LowPowerMode.html#//apple_ref/doc/uid/TP40015243-CH31-SW1</p>

<h2 id="결론">결론</h2>
<p>백그라운드 환경에서의 제약사항이 많은 만큼 어떤 작업을 적절히 수행하기 위한 방법을 잘 파악하고 있어야함.</p>
:ET